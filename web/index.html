<!DOCTYPE html>
<html lang="de" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X-iNet filter for families v1.1</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@3.9.4/dist/full.css" rel="stylesheet" type="text/css" />
    <style>
        body { background: radial-gradient(circle at top left, #1a1c2c, #0f1016); min-height: 100vh; color: #e2e8f0; }
        .glass-card { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.05); }
        .neon-text { text-shadow: 0 0 10px rgba(34, 197, 94, 0.5); }
        .stat-value { font-family: 'JetBrains Mono', 'Courier New', monospace; letter-spacing: -1px; }
        
        .cyber-banner {
            background: linear-gradient(90deg, #1e1b4b 0%, #0f172a 50%, #064e3b 100%);
            position: relative;
            overflow: hidden;
            border-bottom: 2px solid rgba(34, 197, 94, 0.2);
        }
        .cyber-grid {
            position: absolute;
            inset: 0;
            background-image: linear-gradient(rgba(34, 197, 94, 0.1) 1px, transparent 1px), 
                              linear-gradient(90deg, rgba(34, 197, 94, 0.1) 1px, transparent 1px);
            background-size: 30px 30px;
            mask-image: linear-gradient(to bottom, black, transparent);
            animation: pulse-grid 8s linear infinite;
        }
        @keyframes pulse-grid { 0% { transform: translateY(0); } 100% { transform: translateY(30px); } }
        select option { background-color: #1a1c2c !important; color: white !important; }
        textarea::placeholder { color: rgba(255, 255, 255, 0.2); font-style: italic; white-space: pre-line; }
    </style>
</head>
<body class="pb-20">

<div class="cyber-banner w-full py-16 mb-10 shadow-2xl">
    <div class="cyber-grid"></div>
    <div class="relative z-10 max-w-6xl mx-auto px-6">
        <div class="flex flex-col md:flex-row justify-between items-center gap-8">
            <div class="text-center md:text-left max-w-3xl">
                <h1 class="text-4xl md:text-5xl font-black italic tracking-tighter text-white uppercase leading-none">
                    X-iNet filter <span class="text-xl md:text-2xl font-light normal-case opacity-80 text-success neon-text">for families v1.1</span>
                </h1>
                <p class="text-xs uppercase tracking-[0.4em] font-bold text-success/70 mt-4">Multi-Format Filter Pipeline</p>
                <p class="mt-6 text-sm leading-relaxed text-white/50 max-w-2xl italic border-l-2 border-success/30 pl-4">
                    Die BLACKLIST - ein unsichtbarer Schutz-Schild fuer dein Internet zu Hause. Sie sammelt automatisch Listen mit schlechten Webseiten und sorgt dafuer, dass dein Router diese blockiert, damit alle in der Familie sicher im Netz surfen koennen.
                </p>
            </div>
            <div class="flex flex-col gap-3">
                <div class="badge badge-outline border-success/30 text-success text-[10px] py-3 px-4 uppercase font-bold tracking-widest">System Online</div>
                <div class="badge badge-outline border-info/30 text-info text-[10px] py-3 px-4 uppercase font-bold tracking-widest text-center">Pipeline Ready</div>
            </div>
        </div>
    </div>
</div>

<div class="max-w-6xl mx-auto px-4 space-y-6">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
        <div class="stats glass-card shadow-2xl"><div class="stat"><div class="stat-title text-[10px] uppercase font-bold text-white/40">Domains</div><div class="stat-value text-success text-3xl" id="stat-total">0</div></div></div>
        <div class="stats glass-card shadow-2xl"><div class="stat border-white/5"><div class="stat-title text-[10px] uppercase font-bold text-white/40">Filter</div><div class="stat-value text-info text-3xl" id="stat-filters">0</div></div></div>
        <div class="stats glass-card shadow-2xl"><div class="stat"><div class="stat-title text-[10px] uppercase font-bold text-white/40">Aktiv</div><div class="stat-value text-warning text-3xl" id="stat-selected">0</div></div></div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
        <aside class="lg:col-span-4 space-y-6">
            <div class="card glass-card p-6 rounded-3xl"><h3 class="text-[10px] font-bold uppercase mb-4 tracking-widest text-white/50">Quellen-Status</h3><div id="sources-list" class="space-y-4 text-xs"></div></div>
            <div class="card glass-card p-6 rounded-3xl"><h3 class="text-[10px] font-bold uppercase mb-4 tracking-widest text-white/50">1. Schutz-Level</h3><div class="grid grid-cols-1 gap-3" id="cat-group"></div></div>
        </aside>

        <main class="lg:col-span-8 space-y-6">
            <div class="card glass-card p-8 rounded-3xl">
                <h3 class="text-[10px] font-bold uppercase mb-6 tracking-widest text-white/50">2. Limiter & Whitelist</h3>
                <div class="space-y-8">
                    <div class="form-control">
                        <label class="label"><span class="label-text text-white/70">Ranking Limit: <span class="text-success font-bold" id="limit-val">10'000</span></span></label>
                        <input type="range" id="limit-range" min="1000" max="150000" step="1000" value="10000" class="range range-success range-xs">
                    </div>
                    <div class="form-control">
                        <label class="label"><span class="label-text text-white/70">Whitelist (Ausnahmen)</span></label>
                        <textarea id="whitelist-input" class="textarea textarea-bordered bg-black/30 h-28 font-mono text-sm border-white/10" 
                                  placeholder="Beispiel:&#10;facebook.com&#10;instagram.com&#10;tiktok.com" 
                                  oninput="saveAndRefresh()"></textarea>
                    </div>
                </div>
            </div>

            <div class="card glass-card p-8 rounded-3xl">
                <h3 class="text-[10px] font-bold uppercase mb-6 tracking-widest text-white/50">3. Ziel-System</h3>
                <div class="flex flex-col md:flex-row gap-4 items-end">
                    <div class="form-control w-full">
                        <select id="target-system" class="select select-bordered bg-black/40 w-full border-white/10" onchange="updateUI()">
                            <option value="hosts">Universal HOSTS [max. 1'000'000+]</option>
                            <option value="flint2" selected>GL.iNet GL-MT6000 (Flint 2) [max. 150'000]</option>
                            <option value="adguard">AdGuard Home [max. 200'000]</option>
                            <option value="pihole">Pi-hole DNS [max. 500'000]</option>
                            <option value="bind">BIND RPZ [max. 100'000]</option>
                            <option value="mikrotik">Mikrotik RouterOS [max. 20'000]</option>
                            <option value="pfsense">pfSense Unbound [max. 150'000]</option>
                            <option value="unbound">Standard Unbound [max. 150'000]</option>
                            <option value="csv">CSV Daten-Export [Ranking]</option>
                            <option value="json">JSON Daten Feed [Rohdaten]</option>
                        </select>
                    </div>
                    <button class="btn btn-success px-10 font-bold text-xs" onclick="downloadConfig()">Download</button>
                </div>
                <div class="mt-6 p-4 bg-black/50 border border-white/5 rounded-2xl flex items-center justify-between gap-4">
                    <div class="overflow-hidden">
                        <div class="text-[9px] uppercase opacity-40 mb-2 font-bold">Direkt-Link [cite: 2026-01-20]:</div>
                        <a id="router-link" class="text-xs text-info font-mono truncate block" target="_blank" href="#">Wird generiert...</a>
                    </div>
                    <div class="flex flex-col items-center">
                        <button onclick="copyToClipboard()" class="btn btn-circle btn-sm btn-ghost hover:bg-success/20 text-success"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" /></svg></button>
                        <span id="copy-status" class="text-[8px] uppercase font-black text-success opacity-0">Kopiert!</span>
                    </div>
                </div>
            </div>

            <div class="card glass-card p-8 rounded-3xl overflow-hidden">
                <h3 class="text-[10px] font-bold uppercase mb-4 tracking-widest text-success/80">Vorschau</h3>
                <div class="bg-black/60 p-5 rounded-2xl font-mono text-[11px] text-success/70 max-h-56 overflow-y-auto border border-white/5" id="preview-area"></div>
            </div>
        </main>
    </div>
    <footer class="text-center py-12 opacity-20 text-[9px] tracking-[0.4em] uppercase font-bold">
        X-iNET Filter Dashboard &bull; v1.1 &bull; <span id="current-year">2026</span>
    </footer>
</div>

<script>
    const GITHUB_BASE = "https://raw.githubusercontent.com/albertuszerk/inetfilterlist/main/output/";
    let masterStats = null, exportData = [];
    const sys = {
        hosts: { f: "xinet_universal_hosts.txt", p: "0.0.0.0 " },
        flint2: { f: "xinet_flint2.hosts", p: "" },
        adguard: { f: "xinet_adguard.txt", p: "||", s: "^" },
        pihole: { f: "xinet_pihole.txt", p: "" },
        bind: { f: "xinet_bind.rpz", p: "", s: " CNAME ." },
        mikrotik: { f: "xinet_mikrotik.rsc", p: "/ip dns static add name=", s: " address=0.0.0.0" },
        pfsense: { f: "xinet_pfsense.conf", p: "local-zone: \"", s: "\" static" },
        unbound: { f: "xinet_unbound.conf", p: "local-data: \"", s: " A 0.0.0.0\"" },
        csv: { f: "xinet_data.csv", p: "" },
        json: { f: "xinet_data.json", raw: true }
    };
    const categories = ["violence", "sex", "vpn_proxy", "gambling", "ads_tracking", "social"];
    function fmt(num) { return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, "'"); }

    async function init() {
        // Jahr dynamisch setzen
        document.getElementById('current-year').innerText = new Date().getFullYear();

        const group = document.getElementById('cat-group');
        group.innerHTML = categories.map(c => `
            <div class="flex justify-between items-center bg-white/5 p-3 rounded-2xl border border-white/5">
                <span class="text-[10px] font-bold uppercase tracking-widest text-white/50">${c.replace('_', ' ')}</span>
                <input type="checkbox" checked value="${c}" class="toggle toggle-success toggle-sm" onchange="updateUI()">
            </div>
        `).join('');
        try {
            const savedWhitelist = localStorage.getItem('xinet_whitelist_storage');
            document.getElementById('whitelist-input').value = savedWhitelist || '';
            const sRes = await fetch('../output/status.json'), dRes = await fetch('../output/xinet_data.json');
            masterStats = await sRes.json(); exportData = await dRes.json();
            renderStats(); updateUI();
        } catch (e) { document.getElementById('sources-list').innerText = "Status-Error."; }
    }

    function saveAndRefresh() {
        localStorage.setItem('xinet_whitelist_storage', document.getElementById('whitelist-input').value);
        updateUI();
    }

    function renderStats() {
        document.getElementById('stat-total').innerText = fmt(masterStats.total_domains);
        let fc = 0, html = "";
        for (const [c, n] of Object.entries(masterStats.categories)) {
            fc += n; html += `<div class="flex justify-between items-center text-[11px] mb-3"><span class="flex items-center gap-3"><span class="relative flex h-2 w-2"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-success opacity-75"></span><span class="relative inline-flex rounded-full h-2 w-2 bg-success"></span></span><span class="tracking-widest font-bold opacity-70">${c.toUpperCase()}</span></span><span class="font-mono opacity-40 text-[10px]">${fmt(n)}</span></div>`;
        }
        document.getElementById('stat-filters').innerText = fmt(fc);
        document.getElementById('sources-list').innerHTML = html;
    }

    function updateUI() {
        const lim = document.getElementById('limit-range').value, sk = document.getElementById('target-system').value, conf = sys[sk];
        document.getElementById('limit-val').innerText = fmt(lim);
        const wl = document.getElementById('whitelist-input').value.split('\n').map(d => d.trim().toLowerCase()).filter(d => d);
        const cats = Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(c => c.value);
        const filtered = exportData.filter(i => cats.includes(i.c) && !wl.includes(i.d.toLowerCase())).slice(0, lim);
        document.getElementById('stat-selected').innerText = fmt(filtered.length);
        document.getElementById('router-link').href = GITHUB_BASE + conf.f; 
        document.getElementById('router-link').innerText = GITHUB_BASE + conf.f;
        let txt = "";
        filtered.slice(0, 15).forEach(i => txt += conf.raw ? JSON.stringify(i) + "\n" : `${conf.p || ""}${i.d}${conf.s || ""}\n`);
        document.getElementById('preview-area').innerText = txt || "Bereitschaft hergestellt.";
    }

    function downloadConfig() {
        const sk = document.getElementById('target-system').value, conf = sys[sk];
        const wl = document.getElementById('whitelist-input').value.split('\n').map(d => d.trim().toLowerCase()).filter(d => d);
        const cats = Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(c => c.value);
        const filtered = exportData.filter(i => cats.includes(i.c) && !wl.includes(i.d.toLowerCase())).slice(0, document.getElementById('limit-range').value);
        let content = filtered.map(i => conf.raw ? JSON.stringify(i) : `${conf.p || ""}${i.d}${conf.s || ""}`).join("\n");
        const a = document.createElement('a'); a.href = window.URL.createObjectURL(new Blob([content])); a.download = conf.f; a.click();
    }

    function copyToClipboard() {
        navigator.clipboard.writeText(document.getElementById('router-link').href).then(() => {
            const s = document.getElementById('copy-status'); s.style.opacity = "1";
            setTimeout(() => s.style.opacity = "0", 2000);
        });
    }
    document.getElementById('limit-range').addEventListener('input', updateUI);
    init();
</script>
</body>
</html>